Instalação
==========

$ yay -S snapper snapper-gui-git grub-btrfs snap-pac snapper-support


Configuração
============

$ sudo snapper -c root create-config /

$ ediroot /etc/snapper/configs/root

ALLOW_USERS="seilaeu"


$ sudo btrfs sub delete /.snapshots/

$ montar /dev/sdaX /mnt

$ sudo btrfs sub create /mnt/@snapshots

$ desmontar /mnt

$ sudo mkdir /.snapshots

$ sudo chmod a+rw /.snapshots

$ ediroot /etc/fstab

# Snapshots
UUID=f32fe064-2d79-4924-9352-6d91afe1e0f0 /.snapshots btrfs rw,noatime,compress=zstd:3,ssd,discard=async,space_cache=v2,subvolid=291,subvol=/@snapshots 0 0

$ montar /.snapshots

$ sudo systemctl enable --now snapper-timeline.timer

$ sudo systemctl enable --now snapper-cleanup.timer

$ sudo systemctl enable --now grub-btrfs.path


Snapshot Inicial
================

$ snapper -c root create -c timeline --description "Snapshot inicial"


Restaurar uma snapshot
======================

$ montar /dev/sdaX /mnt

$ sudo systemctl stop snapper-timeline.timer

$ sudo systemctl stop snapper-cleanup.timer

$ sudo mv @ @broken

$ sudo btrfs subvolume snapshot /.snapshots/X/snapshot @

$ ediroot /etc/fstab

Mudar o valor de subvolid para o do snapshot restaurado

$ reboot
